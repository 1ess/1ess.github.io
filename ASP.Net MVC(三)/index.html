<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author"><title> · A Sort Of A Blog</title><meta name="description" content="这一篇，我们具体说说 Controller、Model 和 View。
Controller
在 MVC 中，Controller 是用来处理用户请求的。Controller 是一个类，继承自 System.Web.Mvc.Controller。控制器类中访问修饰符为 public 的方法称为 Ac"><meta name="keywords" content=""><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="https://cdn.jsdelivr.net/gh/1ess/cdn/h4cker/favicon-32x32.png" type="image/x-icon"><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="stylesheet" href="/css/style.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><meta name="generator" content="Hexo 5.4.0"><link rel="stylesheet" href="/css/prism.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div id="stage" class="container"><div class="row"><div id="side-bar" class="col-sm-3 col-xs-12 side-container invisible"><div class="vertical-text site-title"><h3 tabindex="-1" class="site-title-small"><a href="/" class="a-title">0x7c00</a></h3><h1 tabindex="-1" class="site-title-large"><a href="/" class="a-title">张冬冬的博客</a></h1><!--h6(onclick="triggerSiteNav()") Trigger--></div><br class="visible-lg visible-md visible-sm"><div id="site-nav" class="site-title-links"><ul><li><a href="/">首頁</a></li><li><a href="/archives">歸檔</a></li><li class="soc"><a href="https://github.com/1ess" target="_blank" rel="noopener noreferrer"><i class="fa fa-github">&nbsp;</i></a></li></ul><div class="visible-lg visible-md visible-sm site-nav-footer"><br class="site-nav-footer-br"><footer><p>&copy;&nbsp;2021&nbsp;</p><p>如果五分钟后她必须进安检，如果安检在十米之外</p><p>那意味着，你们可以亲吻四分五十秒。&nbsp;</p></footer></div></div></div><div id="main-container" class="col-sm-9 col-xs-12 main-container invisible"><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post-container"><p class="post-title"><a></a></p><p class="post-meta"><span class="date meta-item">發佈於&nbsp;2021-07-14</span></p><p class="post-abstract"><p>这一篇，我们具体说说 Controller、Model 和 View。</p>
<h2 id="Controller"><a href="#Controller" class="headerlink" title="Controller"></a>Controller</h2><hr>
<p>在 MVC 中，Controller 是用来处理用户请求的。Controller 是一个类，继承自 System.Web.Mvc.Controller。<br>控制器类中访问修饰符为 public 的方法称为 Action 方法。<br>Controller 和 Action 方法一起，用来处理来自客户端的请求，检索必要的模型数据并返回适当的响应。<br>在 ASP.Net MVC 中，每个控制器类名称必须以 Controller 结尾，此外，每个控制器类必须位于 MVC 文件夹结构的 Controllers 文件夹中。</p>
<h3 id="Action-方法"><a href="#Action-方法" class="headerlink" title="Action 方法"></a>Action 方法</h3><p>Action 方法的特征: </p>
<ul>
<li>Action 方法必须是 public，不能是 private 或 protected</li>
<li>Action 方法不能 overloaded</li>
<li>Action 方法不能是 static 方法</li>
</ul>
<h3 id="默认-Action-方法"><a href="#默认-Action-方法" class="headerlink" title="默认 Action 方法"></a>默认 Action 方法</h3><p>每个 Controller 都有默认的 Action 方法定义在 RouteConfig 类中。</p>
<h3 id="ActionResult-类型"><a href="#ActionResult-类型" class="headerlink" title="ActionResult 类型"></a>ActionResult 类型</h3><p>Action 方法一般需要返回 ActionResult 类型的返回值。<br>View() 方法就是定义在基类中 Controller 中，返回 ActionResult 类型。<br>MVC 框架包括各种可以被 Action 方法返回的 result 类型。result 类型表示不同类型的响应，如: HTML，file，string，Json，JavaScript 等。</p>
<table>
<thead>
<tr>
<th>Result 类型</th>
<th>描述</th>
<th>Base Controller 方法</th>
</tr>
</thead>
<tbody><tr>
<td>ViewResult</td>
<td>返回 HTML</td>
<td>View()</td>
</tr>
<tr>
<td>EmptyResult</td>
<td>什么都不返回</td>
<td></td>
</tr>
<tr>
<td>ContentResult</td>
<td>返回字符串</td>
<td>Content()</td>
</tr>
<tr>
<td>FileContentResult</td>
<td>返回文件内容</td>
<td>File()</td>
</tr>
<tr>
<td>JavaScriptResult</td>
<td>返回 JS</td>
<td>JavaScript()</td>
</tr>
<tr>
<td>JsonResult</td>
<td>返回 JSON</td>
<td>Json()</td>
</tr>
<tr>
<td>RedirectResult</td>
<td>重定向新的 url</td>
<td>Redirect()</td>
</tr>
<tr>
<td>RedirectToRouteResult</td>
<td>重定向其他的 Action</td>
<td>RedirectToAction()</td>
</tr>
<tr>
<td>HttpUnauthorizedResult</td>
<td>返回 HTTP 403 status</td>
<td></td>
</tr>
</tbody></table>
<p>ActionResult 类是所有上述结果类的基类。</p>
<h3 id="Action-Selectors"><a href="#Action-Selectors" class="headerlink" title="Action Selectors"></a>Action Selectors</h3><p>Action Selectors 是应用于 Action 方法的 attribute。<br>Action Selectors 有助于路由引擎选择正确的操作方法来处理特定请求。<br>MVC 5 包括如下 action selector attributes:</p>
<ul>
<li>ActionName</li>
<li>NonAction</li>
<li>ActionVerbs</li>
</ul>
<h4 id="ActionName"><a href="#ActionName" class="headerlink" title="ActionName"></a>ActionName</h4><p>ActionName 允许我们指定与 Action 的名称不同的操作名称。</p>
<pre class="line-numbers language-csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FooController</span> <span class="token punctuation">:</span> Controller
<span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token function">ActionName</span><span class="token punctuation">(</span><span class="token string">"bar"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> ActionResult <span class="token function">foo</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span>
    <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">View</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>
<span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>上面的例子，我们应发送 <a target="_blank" rel="noopener" href="http://localhost/foo/bar/1">http://localhost/foo/bar/1</a> 而不是 <a target="_blank" rel="noopener" href="http://localhost/foo/foo/1%E3%80%82">http://localhost/foo/foo/1。</a></p>
<h4 id="NonAction"><a href="#NonAction" class="headerlink" title="NonAction"></a>NonAction</h4><p>NonAction selector attribute 指示 Controller 的公共方法不是 Action 方法。<br>如果需要控制器中的公共方法但不希望将其视为 Action 方法，就需要使用 NonAction attribute。</p>
<pre class="line-numbers language-csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FooController</span> <span class="token punctuation">:</span> Controller
<span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  
    <span class="token punctuation">[</span>NonAction<span class="token punctuation">]</span>
    <span class="token keyword">public</span> Bar <span class="token function">GetBar</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span>
    <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span> 
        <span class="token keyword">return</span> barList<span class="token punctuation">.</span><span class="token function">FirstOrDefault</span><span class="token punctuation">(</span>s <span class="token operator">=</span><span class="token operator">></span> s<span class="token punctuation">.</span>Id <span class="token operator">==</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>
<span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="ActionVerbs-行为动词"><a href="#ActionVerbs-行为动词" class="headerlink" title="ActionVerbs(行为动词)"></a>ActionVerbs(行为动词)</h4><p>控制 Action 方法所使用的 HTTP 方法，需要使用 ActionVerbs。<br>如: 我们可以使用相同的 ActionName 定义两个不同的操作方法，一个操作方法响应 HTTP Get 请求，另一个操作方法响应 HTTP Post 请求。</p>
<p>ActionVerbs 包括:<br>HttpGet，HttpPost，HttpPut，HttpDelete，HttpPatch，HttpOptions，HttpHead<br>我们也可以使用 AcceptVerbs attribute 接受多个 HttpVerbs，如: </p>
<pre class="line-numbers language-csharp"><code class="language-csharp"><span class="token punctuation">[</span><span class="token function">AcceptVerbs</span><span class="token punctuation">(</span>HttpVerbs<span class="token punctuation">.</span>Post <span class="token operator">|</span> HttpVerbs<span class="token punctuation">.</span>Get<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">public</span> ActionResult <span class="token function">GetAndPostMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">RedirectToAction</span><span class="token punctuation">(</span><span class="token string">"Index"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="Model"><a href="#Model" class="headerlink" title="Model"></a>Model</h2><hr>
<p>Model 表示 MVC 架构中的域特定数据和业务逻辑。<br>模型类在公共属性中保存数据。所有 Model 类都保存在 Models 文件夹中。</p>
<h2 id="View"><a href="#View" class="headerlink" title="View"></a>View</h2><hr>
<p>View 是一个用户界面。 View 将模型中的数据显示给用户，并使他们能够修改数据。<br>视图存储在 Views文件夹中。</p>
<p>单个控制器类的不同 Action 方法可以呈现不同的视图，因此 Views 文件夹包含每个控制器的单独文件夹，其名称与控制器相同。View 文件名与 Action 方法同名。</p>
<h3 id="Razor-View-Engine"><a href="#Razor-View-Engine" class="headerlink" title="Razor View Engine"></a>Razor View Engine</h3><p>Microsoft 在 MVC 3 中推出了 Razor 视图引擎，我们可以在 Razor 视图混合写服务端代码和 html 标签 。<br>Razor 使用 @ 字符来编写服务端代码， Razor 视图以 .cshtml 作为后缀。</p>
<p>之后我们会详细介绍 Razor 语法，这里我们先看看其他重要的概念。</p>
<h3 id="创建视图"><a href="#创建视图" class="headerlink" title="创建视图"></a>创建视图</h3><p>最佳实践是使得视图名与 Action 方法同名，使得当我们返回 View 时无需传递路径作为参数。<br>ASP.NET MVC 中的每个视图都派生自 System.Web.Mvc 命名空间中的 WebViewPage 类。</p>
</p></div><div class="pagination"><p class="clearfix"><span class="pre pagbuttons"><a role="navigation" href="/ASP.Net%20MVC(%E4%BA%8C)/" title=""><i class="fa fa-angle-double-left"></i>&nbsp;上一篇: </a></span><span>&nbsp;</span><span class="next pagbuttons"><a role="navigation" href="/ASP.Net%20MVC(%E5%9B%9B)/" title="">下一篇: &nbsp;<i class="fa fa-angle-double-right"></i></a></span></p></div></div></div></div><div class="visible-xs site-bottom-footer"><footer><p>&copy;&nbsp;2021&nbsp;</p><p>如果五分钟后她必须进安检，如果安检在十米之外</p><p>那意味着，你们可以亲吻四分五十秒。&nbsp;</p></footer></div></div></div></div><script src="/js/jquery-3.1.0.min.js"></script><script src="/js/bootstrap.min.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script><script src="/js/google-analytics.js"></script><script src="/js/typography.js"></script></body></html>