<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author"><title> · A Sort Of A Blog</title><meta name="description" content="上篇，我们介绍了 Python 基础 HTTP 库 urllib 的基本使用，在使用上还是比较麻烦的，本篇，我们来看一下第三方 HTTP 库 Requests 是如何简化我们的操作的。
Requests
Requests 是基于 urllib，采用 Apache2 Licensed 开源协议的 HT"><meta name="keywords" content=""><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="https://cdn.jsdelivr.net/gh/1ess/cdn/h4cker/favicon-32x32.png" type="image/x-icon"><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="stylesheet" href="/css/style.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><meta name="generator" content="Hexo 5.4.0"><link rel="stylesheet" href="/css/prism.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div id="stage" class="container"><div class="row"><div id="side-bar" class="col-sm-3 col-xs-12 side-container invisible"><div class="vertical-text site-title"><h3 tabindex="-1" class="site-title-small"><a href="/" class="a-title">0x7c00</a></h3><h1 tabindex="-1" class="site-title-large"><a href="/" class="a-title">张冬冬的博客</a></h1><!--h6(onclick="triggerSiteNav()") Trigger--></div><br class="visible-lg visible-md visible-sm"><div id="site-nav" class="site-title-links"><ul><li><a href="/">首頁</a></li><li><a href="/archives">歸檔</a></li><li class="soc"><a href="https://github.com/1ess" target="_blank" rel="noopener noreferrer"><i class="fa fa-github">&nbsp;</i></a></li></ul><div class="visible-lg visible-md visible-sm site-nav-footer"><br class="site-nav-footer-br"><footer><p>&copy;&nbsp;2021&nbsp;</p><p>如果五分钟后她必须进安检，如果安检在十米之外</p><p>那意味着，你们可以亲吻四分五十秒。&nbsp;</p></footer></div></div></div><div id="main-container" class="col-sm-9 col-xs-12 main-container invisible"><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post-container"><p class="post-title"><a></a></p><p class="post-meta"><span class="date meta-item">發佈於&nbsp;2021-07-14</span></p><p class="post-abstract"><p>上篇，我们介绍了 Python 基础 HTTP 库 urllib 的基本使用，在使用上还是比较麻烦的，本篇，我们来看一下第三方 HTTP 库 Requests 是如何简化我们的操作的。</p>
<h2 id="Requests"><a href="#Requests" class="headerlink" title="Requests"></a>Requests</h2><hr>
<p>Requests 是基于 urllib，采用 Apache2 Licensed 开源协议的 HTTP 库，他比 urllib 更加方便，节约我们大量的工作。</p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight python"><table><tr><td class="code"><pre class="line-numbers language-hljs python"><code class="language-hljs python">pip3 install requests<br><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></td></tr></table></figure>

<h3 id="请求"><a href="#请求" class="headerlink" title="请求"></a>请求</h3><h4 id="基本-GET-请求"><a href="#基本-GET-请求" class="headerlink" title="基本 GET 请求"></a>基本 GET 请求</h4><figure class="highlight python"><table><tr><td class="code"><pre class="line-numbers language-hljs python"><span class="hljs-keyword">import</span> requests<br>response = requests.get(<span class="hljs-string">&#x27;http://httpbin.org/get&#x27;</span>)<br><span class="hljs-built_in">print</span>(response.status_code)<br><span class="hljs-built_in">print</span>(response.text)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(response.text))<br><br><span class="hljs-comment"># 200</span><br><br><span class="hljs-comment"># &#123;</span><br><span class="hljs-comment">#   &quot;args&quot;: &#123;&#125;, </span><br><span class="hljs-comment">#   &quot;headers&quot;: &#123;</span><br><span class="hljs-comment">#     &quot;Accept&quot;: &quot;*/*&quot;, </span><br><span class="hljs-comment">#     &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, </span><br><span class="hljs-comment">#     &quot;Host&quot;: &quot;httpbin.org&quot;, </span><br><span class="hljs-comment">#     &quot;User-Agent&quot;: &quot;python-requests/2.21.0&quot;</span><br><span class="hljs-comment">#   &#125;, </span><br><span class="hljs-comment">#   &quot;origin&quot;: &quot;42.100.1.169, 42.100.1.169&quot;, </span><br><span class="hljs-comment">#   &quot;url&quot;: &quot;https://httpbin.org/get&quot;</span><br><span class="hljs-comment"># &#125;</span><br><br><span class="hljs-comment"><code class="language-hljs python"><span class="hljs-keyword">import</span> requests<br>response = requests.get(<span class="hljs-string">&#x27;http://httpbin.org/get&#x27;</span>)<br><span class="hljs-built_in">print</span>(response.status_code)<br><span class="hljs-built_in">print</span>(response.text)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(response.text))<br><br><span class="hljs-comment"># 200</span><br><br><span class="hljs-comment"># &#123;</span><br><span class="hljs-comment">#   &quot;args&quot;: &#123;&#125;, </span><br><span class="hljs-comment">#   &quot;headers&quot;: &#123;</span><br><span class="hljs-comment">#     &quot;Accept&quot;: &quot;*/*&quot;, </span><br><span class="hljs-comment">#     &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, </span><br><span class="hljs-comment">#     &quot;Host&quot;: &quot;httpbin.org&quot;, </span><br><span class="hljs-comment">#     &quot;User-Agent&quot;: &quot;python-requests/2.21.0&quot;</span><br><span class="hljs-comment">#   &#125;, </span><br><span class="hljs-comment">#   &quot;origin&quot;: &quot;42.100.1.169, 42.100.1.169&quot;, </span><br><span class="hljs-comment">#   &quot;url&quot;: &quot;https://httpbin.org/get&quot;</span><br><span class="hljs-comment"># &#125;</span><br><br><span class="hljs-comment"># <class &#x27;str&#x27;></span><br><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></td></tr></table></figure>

<h4 id="带有参数-GET-请求"><a href="#带有参数-GET-请求" class="headerlink" title="带有参数 GET 请求"></a>带有参数 GET 请求</h4><figure class="highlight python"><table><tr><td class="code"><pre class="line-numbers language-hljs python"><span class="hljs-keyword">import</span> requests<br>response = requests.get(<span class="hljs-string">&#x27;http://httpbin.org/get?foo=bar&#x27;</span>)<br><span class="hljs-built_in">print</span>(response.text)<br><br><span class="hljs-comment"># &#123;</span><br><span class="hljs-comment">#   &quot;args&quot;: &#123;</span><br><span class="hljs-comment">#     &quot;foo&quot;: &quot;bar&quot;</span><br><span class="hljs-comment">#   &#125;, </span><br><span class="hljs-comment">#   &quot;headers&quot;: &#123;</span><br><span class="hljs-comment">#     &quot;Accept&quot;: &quot;*/*&quot;, </span><br><span class="hljs-comment">#     &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, </span><br><span class="hljs-comment">#     &quot;Host&quot;: &quot;httpbin.org&quot;, </span><br><span class="hljs-comment">#     &quot;User-Agent&quot;: &quot;python-requests/2.21.0&quot;</span><br><span class="hljs-comment">#   &#125;, </span><br><span class="hljs-comment">#   &quot;origin&quot;: &quot;42.100.1.169, 42.100.1.169&quot;, </span><br><span class="hljs-comment">#   &quot;url&quot;: &quot;https://httpbin.org/get?foo=bar&quot;</span><br><span class="hljs-comment"># &#125;</span><br><br>params = &#123;<span class="hljs-string">&#x27;foo&#x27;</span>: <span class="hljs-string">&#x27;bar&#x27;</span>&#125;<br>response = requests.get(<span class="hljs-string">&#x27;http://httpbin.org/get&#x27;</span>, params=params)<br><span class="hljs-built_in">print</span>(response.text)<br><br><span class="hljs-comment"># &#123;</span><br><span class="hljs-comment">#   &quot;args&quot;: &#123;</span><br><span class="hljs-comment">#     &quot;foo&quot;: &quot;bar&quot;</span><br><span class="hljs-comment">#   &#125;, </span><br><span class="hljs-comment">#   &quot;headers&quot;: &#123;</span><br><span class="hljs-comment">#     &quot;Accept&quot;: &quot;*/*&quot;, </span><br><span class="hljs-comment">#     &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, </span><br><span class="hljs-comment">#     &quot;Host&quot;: &quot;httpbin.org&quot;, </span><br><span class="hljs-comment">#     &quot;User-Agent&quot;: &quot;python-requests/2.21.0&quot;</span><br><span class="hljs-comment">#   &#125;, </span><br><span class="hljs-comment">#   &quot;origin&quot;: &quot;42.100.1.169, 42.100.1.169&quot;, </span><br><span class="hljs-comment">#   &quot;url&quot;: &quot;https://httpbin.org/get?foo=bar&quot;</span><br><span class="hljs-comment"><code class="language-hljs python"><span class="hljs-keyword">import</span> requests<br>response = requests.get(<span class="hljs-string">&#x27;http://httpbin.org/get?foo=bar&#x27;</span>)<br><span class="hljs-built_in">print</span>(response.text)<br><br><span class="hljs-comment"># &#123;</span><br><span class="hljs-comment">#   &quot;args&quot;: &#123;</span><br><span class="hljs-comment">#     &quot;foo&quot;: &quot;bar&quot;</span><br><span class="hljs-comment">#   &#125;, </span><br><span class="hljs-comment">#   &quot;headers&quot;: &#123;</span><br><span class="hljs-comment">#     &quot;Accept&quot;: &quot;*/*&quot;, </span><br><span class="hljs-comment">#     &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, </span><br><span class="hljs-comment">#     &quot;Host&quot;: &quot;httpbin.org&quot;, </span><br><span class="hljs-comment">#     &quot;User-Agent&quot;: &quot;python-requests/2.21.0&quot;</span><br><span class="hljs-comment">#   &#125;, </span><br><span class="hljs-comment">#   &quot;origin&quot;: &quot;42.100.1.169, 42.100.1.169&quot;, </span><br><span class="hljs-comment">#   &quot;url&quot;: &quot;https://httpbin.org/get?foo=bar&quot;</span><br><span class="hljs-comment"># &#125;</span><br><br>params = &#123;<span class="hljs-string">&#x27;foo&#x27;</span>: <span class="hljs-string">&#x27;bar&#x27;</span>&#125;<br>response = requests.get(<span class="hljs-string">&#x27;http://httpbin.org/get&#x27;</span>, params=params)<br><span class="hljs-built_in">print</span>(response.text)<br><br><span class="hljs-comment"># &#123;</span><br><span class="hljs-comment">#   &quot;args&quot;: &#123;</span><br><span class="hljs-comment">#     &quot;foo&quot;: &quot;bar&quot;</span><br><span class="hljs-comment">#   &#125;, </span><br><span class="hljs-comment">#   &quot;headers&quot;: &#123;</span><br><span class="hljs-comment">#     &quot;Accept&quot;: &quot;*/*&quot;, </span><br><span class="hljs-comment">#     &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, </span><br><span class="hljs-comment">#     &quot;Host&quot;: &quot;httpbin.org&quot;, </span><br><span class="hljs-comment">#     &quot;User-Agent&quot;: &quot;python-requests/2.21.0&quot;</span><br><span class="hljs-comment">#   &#125;, </span><br><span class="hljs-comment">#   &quot;origin&quot;: &quot;42.100.1.169, 42.100.1.169&quot;, </span><br><span class="hljs-comment">#   &quot;url&quot;: &quot;https://httpbin.org/get?foo=bar&quot;</span><br><span class="hljs-comment"># &#125;</span><br><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></td></tr></table></figure>

<h4 id="json-解析"><a href="#json-解析" class="headerlink" title="json 解析"></a>json 解析</h4><figure class="highlight python"><table><tr><td class="code"><pre class="line-numbers language-hljs python"><span class="hljs-keyword">import</span> requests<br>params = &#123;<span class="hljs-string">&#x27;foo&#x27;</span>: <span class="hljs-string">&#x27;bar&#x27;</span>&#125;<br>response = requests.get(<span class="hljs-string">&#x27;http://httpbin.org/get&#x27;</span>, params=params)<br><span class="hljs-built_in">print</span>(response.json())<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(response.json()))<br><br><span class="hljs-comment"># &#123;&#x27;args&#x27;: &#123;&#x27;foo&#x27;: &#x27;bar&#x27;&#125;, &#x27;headers&#x27;: &#123;&#x27;Accept&#x27;: &#x27;*/*&#x27;, &#x27;Accept-Encoding&#x27;: &#x27;gzip, deflate&#x27;, &#x27;Host&#x27;: &#x27;httpbin.org&#x27;, &#x27;User-Agent&#x27;: &#x27;python-requests/2.21.0&#x27;&#125;, &#x27;origin&#x27;: &#x27;42.100.1.169, 42.100.1.169&#x27;, &#x27;url&#x27;: &#x27;https://httpbin.org/get?foo=bar&#x27;&#125;</span><br><span class="hljs-comment"><code class="language-hljs python"><span class="hljs-keyword">import</span> requests<br>params = &#123;<span class="hljs-string">&#x27;foo&#x27;</span>: <span class="hljs-string">&#x27;bar&#x27;</span>&#125;<br>response = requests.get(<span class="hljs-string">&#x27;http://httpbin.org/get&#x27;</span>, params=params)<br><span class="hljs-built_in">print</span>(response.json())<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(response.json()))<br><br><span class="hljs-comment"># &#123;&#x27;args&#x27;: &#123;&#x27;foo&#x27;: &#x27;bar&#x27;&#125;, &#x27;headers&#x27;: &#123;&#x27;Accept&#x27;: &#x27;*/*&#x27;, &#x27;Accept-Encoding&#x27;: &#x27;gzip, deflate&#x27;, &#x27;Host&#x27;: &#x27;httpbin.org&#x27;, &#x27;User-Agent&#x27;: &#x27;python-requests/2.21.0&#x27;&#125;, &#x27;origin&#x27;: &#x27;42.100.1.169, 42.100.1.169&#x27;, &#x27;url&#x27;: &#x27;https://httpbin.org/get?foo=bar&#x27;&#125;</span><br><span class="hljs-comment"># <class &#x27;dict&#x27;></span><br><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></td></tr></table></figure>

<h4 id="二进制数据"><a href="#二进制数据" class="headerlink" title="二进制数据"></a>二进制数据</h4><figure class="highlight python"><table><tr><td class="code"><pre class="line-numbers language-hljs python"><span class="hljs-keyword">import</span> requests<br>response = requests.get(<span class="hljs-string">&#x27;http://github.com/favicon.ico&#x27;</span>)<br><span class="hljs-built_in">print</span>(response.content)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(response.content))<br><br><span class="hljs-comment"># b&#x27;\x00\x00\x01\x00\x02\x00\x10\x10\x00\x00\x01\x00 \x00(\x05\x00\x00&amp;\x00\x00\x00...&#x27;</span><br><span class="hljs-comment"># &lt;class &#x27;bytes&#x27;&gt;</span><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;favicon.ico&#x27;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword"><code class="language-hljs python"><span class="hljs-keyword">import</span> requests<br>response = requests.get(<span class="hljs-string">&#x27;http://github.com/favicon.ico&#x27;</span>)<br><span class="hljs-built_in">print</span>(response.content)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(response.content))<br><br><span class="hljs-comment"># b&#x27;\x00\x00\x01\x00\x02\x00\x10\x10\x00\x00\x01\x00 \x00(\x05\x00\x00&amp;\x00\x00\x00...&#x27;</span><br><span class="hljs-comment"># &lt;class &#x27;bytes&#x27;&gt;</span><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;favicon.ico&#x27;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(response.content)<br><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></td></tr></table></figure>

<h4 id="添加-headers"><a href="#添加-headers" class="headerlink" title="添加 headers"></a>添加 headers</h4><figure class="highlight python"><table><tr><td class="code"><pre class="line-numbers language-hljs python"><span class="hljs-keyword">import</span> requests<br><br>headers = &#123;<br>    <span class="hljs-string">&#x27;User-Agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.157 Safari/537.36&#x27;</span>,<br>    <span class="hljs-string">&#x27;Cookie&#x27;</span>: <span class="hljs-string">&#x27;thw=cn; v=0; t=f49d7a120cef747be295966efd96e846; cookie2=53b3047ac2325fbeb90d604ab16d4e58;...&#x27;</span><br>&#125;<br>response = requests.get(<span class="hljs-string">&#x27;http://zhihu.com/explore&#x27;</span>, headers=headers)<br><span class="hljs-built_in"><code class="language-hljs python"><span class="hljs-keyword">import</span> requests<br><br>headers = &#123;<br>    <span class="hljs-string">&#x27;User-Agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.157 Safari/537.36&#x27;</span>,<br>    <span class="hljs-string">&#x27;Cookie&#x27;</span>: <span class="hljs-string">&#x27;thw=cn; v=0; t=f49d7a120cef747be295966efd96e846; cookie2=53b3047ac2325fbeb90d604ab16d4e58;...&#x27;</span><br>&#125;<br>response = requests.get(<span class="hljs-string">&#x27;http://zhihu.com/explore&#x27;</span>, headers=headers)<br><span class="hljs-built_in">print</span>(response.text)<br><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></td></tr></table></figure>

<h4 id="带有参数-POST-请求"><a href="#带有参数-POST-请求" class="headerlink" title="带有参数 POST 请求"></a>带有参数 POST 请求</h4><figure class="highlight python"><table><tr><td class="code"><pre class="line-numbers language-hljs python"><span class="hljs-keyword">import</span> requests<br><br><span class="hljs-comment"># form-data 提交数据</span><br>response = requests.post(<span class="hljs-string">&#x27;http://httpbin.org/post&#x27;</span>, data=&#123;<span class="hljs-string">&#x27;foo&#x27;</span>: <span class="hljs-string">&#x27;bar&#x27;</span>&#125;)<br><span class="hljs-built_in">print</span>(response.text)<br><br><span class="hljs-comment"># &#123;</span><br><span class="hljs-comment">#   &quot;args&quot;: &#123;&#125;,</span><br><span class="hljs-comment">#   &quot;data&quot;: &quot;&quot;,</span><br><span class="hljs-comment">#   &quot;files&quot;: &#123;&#125;,</span><br><span class="hljs-comment">#   &quot;form&quot;: &#123;</span><br><span class="hljs-comment">#     &quot;foo&quot;: &quot;bar&quot;</span><br><span class="hljs-comment">#   &#125;,</span><br><span class="hljs-comment">#   &quot;headers&quot;: &#123;</span><br><span class="hljs-comment">#     &quot;Accept&quot;: &quot;*/*&quot;,</span><br><span class="hljs-comment">#     &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;,</span><br><span class="hljs-comment">#     &quot;Content-Length&quot;: &quot;7&quot;,</span><br><span class="hljs-comment">#     &quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded&quot;,</span><br><span class="hljs-comment">#     &quot;Host&quot;: &quot;httpbin.org&quot;,</span><br><span class="hljs-comment">#     &quot;User-Agent&quot;: &quot;python-requests/2.21.0&quot;</span><br><span class="hljs-comment">#   &#125;,</span><br><span class="hljs-comment">#   &quot;json&quot;: null,</span><br><span class="hljs-comment">#   &quot;origin&quot;: &quot;42.100.1.20, 42.100.1.20&quot;,</span><br><span class="hljs-comment">#   &quot;url&quot;: &quot;https://httpbin.org/post&quot;</span><br><span class="hljs-comment"># &#125;</span><br><br>response = requests.post(<span class="hljs-string">&#x27;http://httpbin.org/post&#x27;</span>, data=<span class="hljs-string">&#x27;foo&#x27;</span>)<br><span class="hljs-built_in">print</span>(response.text)<br><br><span class="hljs-comment"># &#123;</span><br><span class="hljs-comment">#   &quot;args&quot;: &#123;&#125;, </span><br><span class="hljs-comment">#   &quot;data&quot;: &quot;foo&quot;, </span><br><span class="hljs-comment">#   &quot;files&quot;: &#123;&#125;, </span><br><span class="hljs-comment">#   &quot;form&quot;: &#123;&#125;, </span><br><span class="hljs-comment">#   &quot;headers&quot;: &#123;</span><br><span class="hljs-comment">#     &quot;Accept&quot;: &quot;*/*&quot;, </span><br><span class="hljs-comment">#     &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, </span><br><span class="hljs-comment">#     &quot;Content-Length&quot;: &quot;3&quot;, </span><br><span class="hljs-comment">#     &quot;Host&quot;: &quot;httpbin.org&quot;, </span><br><span class="hljs-comment">#     &quot;User-Agent&quot;: &quot;python-requests/2.21.0&quot;</span><br><span class="hljs-comment">#   &#125;, </span><br><span class="hljs-comment">#   &quot;json&quot;: null, </span><br><span class="hljs-comment">#   &quot;origin&quot;: &quot;42.100.2.79, 42.100.2.79&quot;, </span><br><span class="hljs-comment">#   &quot;url&quot;: &quot;https://httpbin.org/post&quot;</span><br><span class="hljs-comment"># &#125;</span><br><br><span class="hljs-comment"># json 提交数据</span><br>response = requests.post(<span class="hljs-string">&#x27;http://httpbin.org/post&#x27;</span>, json=&#123;<span class="hljs-string">&#x27;foo&#x27;</span>: <span class="hljs-string">&#x27;bar&#x27;</span>&#125;)<br><span class="hljs-built_in">print</span>(response.text)<br><br><span class="hljs-comment"># &#123;</span><br><span class="hljs-comment">#   &quot;args&quot;: &#123;&#125;, </span><br><span class="hljs-comment">#   &quot;data&quot;: &quot;&#123;\&quot;foo\&quot;: \&quot;bar\&quot;&#125;&quot;, </span><br><span class="hljs-comment">#   &quot;files&quot;: &#123;&#125;, </span><br><span class="hljs-comment">#   &quot;form&quot;: &#123;&#125;, </span><br><span class="hljs-comment">#   &quot;headers&quot;: &#123;</span><br><span class="hljs-comment">#     &quot;Accept&quot;: &quot;*/*&quot;, </span><br><span class="hljs-comment">#     &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, </span><br><span class="hljs-comment">#     &quot;Content-Length&quot;: &quot;14&quot;, </span><br><span class="hljs-comment">#     &quot;Content-Type&quot;: &quot;application/json&quot;, </span><br><span class="hljs-comment">#     &quot;Host&quot;: &quot;httpbin.org&quot;, </span><br><span class="hljs-comment">#     &quot;User-Agent&quot;: &quot;python-requests/2.21.0&quot;</span><br><span class="hljs-comment">#   &#125;, </span><br><span class="hljs-comment">#   &quot;json&quot;: &#123;</span><br><span class="hljs-comment">#     &quot;foo&quot;: &quot;bar&quot;</span><br><span class="hljs-comment">#   &#125;, </span><br><span class="hljs-comment">#   &quot;origin&quot;: &quot;42.100.3.225, 42.100.3.225&quot;, </span><br><span class="hljs-comment">#   &quot;url&quot;: &quot;https://httpbin.org/post&quot;</span><br><span class="hljs-comment"><code class="language-hljs python"><span class="hljs-keyword">import</span> requests<br><br><span class="hljs-comment"># form-data 提交数据</span><br>response = requests.post(<span class="hljs-string">&#x27;http://httpbin.org/post&#x27;</span>, data=&#123;<span class="hljs-string">&#x27;foo&#x27;</span>: <span class="hljs-string">&#x27;bar&#x27;</span>&#125;)<br><span class="hljs-built_in">print</span>(response.text)<br><br><span class="hljs-comment"># &#123;</span><br><span class="hljs-comment">#   &quot;args&quot;: &#123;&#125;,</span><br><span class="hljs-comment">#   &quot;data&quot;: &quot;&quot;,</span><br><span class="hljs-comment">#   &quot;files&quot;: &#123;&#125;,</span><br><span class="hljs-comment">#   &quot;form&quot;: &#123;</span><br><span class="hljs-comment">#     &quot;foo&quot;: &quot;bar&quot;</span><br><span class="hljs-comment">#   &#125;,</span><br><span class="hljs-comment">#   &quot;headers&quot;: &#123;</span><br><span class="hljs-comment">#     &quot;Accept&quot;: &quot;*/*&quot;,</span><br><span class="hljs-comment">#     &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;,</span><br><span class="hljs-comment">#     &quot;Content-Length&quot;: &quot;7&quot;,</span><br><span class="hljs-comment">#     &quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded&quot;,</span><br><span class="hljs-comment">#     &quot;Host&quot;: &quot;httpbin.org&quot;,</span><br><span class="hljs-comment">#     &quot;User-Agent&quot;: &quot;python-requests/2.21.0&quot;</span><br><span class="hljs-comment">#   &#125;,</span><br><span class="hljs-comment">#   &quot;json&quot;: null,</span><br><span class="hljs-comment">#   &quot;origin&quot;: &quot;42.100.1.20, 42.100.1.20&quot;,</span><br><span class="hljs-comment">#   &quot;url&quot;: &quot;https://httpbin.org/post&quot;</span><br><span class="hljs-comment"># &#125;</span><br><br>response = requests.post(<span class="hljs-string">&#x27;http://httpbin.org/post&#x27;</span>, data=<span class="hljs-string">&#x27;foo&#x27;</span>)<br><span class="hljs-built_in">print</span>(response.text)<br><br><span class="hljs-comment"># &#123;</span><br><span class="hljs-comment">#   &quot;args&quot;: &#123;&#125;, </span><br><span class="hljs-comment">#   &quot;data&quot;: &quot;foo&quot;, </span><br><span class="hljs-comment">#   &quot;files&quot;: &#123;&#125;, </span><br><span class="hljs-comment">#   &quot;form&quot;: &#123;&#125;, </span><br><span class="hljs-comment">#   &quot;headers&quot;: &#123;</span><br><span class="hljs-comment">#     &quot;Accept&quot;: &quot;*/*&quot;, </span><br><span class="hljs-comment">#     &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, </span><br><span class="hljs-comment">#     &quot;Content-Length&quot;: &quot;3&quot;, </span><br><span class="hljs-comment">#     &quot;Host&quot;: &quot;httpbin.org&quot;, </span><br><span class="hljs-comment">#     &quot;User-Agent&quot;: &quot;python-requests/2.21.0&quot;</span><br><span class="hljs-comment">#   &#125;, </span><br><span class="hljs-comment">#   &quot;json&quot;: null, </span><br><span class="hljs-comment">#   &quot;origin&quot;: &quot;42.100.2.79, 42.100.2.79&quot;, </span><br><span class="hljs-comment">#   &quot;url&quot;: &quot;https://httpbin.org/post&quot;</span><br><span class="hljs-comment"># &#125;</span><br><br><span class="hljs-comment"># json 提交数据</span><br>response = requests.post(<span class="hljs-string">&#x27;http://httpbin.org/post&#x27;</span>, json=&#123;<span class="hljs-string">&#x27;foo&#x27;</span>: <span class="hljs-string">&#x27;bar&#x27;</span>&#125;)<br><span class="hljs-built_in">print</span>(response.text)<br><br><span class="hljs-comment"># &#123;</span><br><span class="hljs-comment">#   &quot;args&quot;: &#123;&#125;, </span><br><span class="hljs-comment">#   &quot;data&quot;: &quot;&#123;\&quot;foo\&quot;: \&quot;bar\&quot;&#125;&quot;, </span><br><span class="hljs-comment">#   &quot;files&quot;: &#123;&#125;, </span><br><span class="hljs-comment">#   &quot;form&quot;: &#123;&#125;, </span><br><span class="hljs-comment">#   &quot;headers&quot;: &#123;</span><br><span class="hljs-comment">#     &quot;Accept&quot;: &quot;*/*&quot;, </span><br><span class="hljs-comment">#     &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, </span><br><span class="hljs-comment">#     &quot;Content-Length&quot;: &quot;14&quot;, </span><br><span class="hljs-comment">#     &quot;Content-Type&quot;: &quot;application/json&quot;, </span><br><span class="hljs-comment">#     &quot;Host&quot;: &quot;httpbin.org&quot;, </span><br><span class="hljs-comment">#     &quot;User-Agent&quot;: &quot;python-requests/2.21.0&quot;</span><br><span class="hljs-comment">#   &#125;, </span><br><span class="hljs-comment">#   &quot;json&quot;: &#123;</span><br><span class="hljs-comment">#     &quot;foo&quot;: &quot;bar&quot;</span><br><span class="hljs-comment">#   &#125;, </span><br><span class="hljs-comment">#   &quot;origin&quot;: &quot;42.100.3.225, 42.100.3.225&quot;, </span><br><span class="hljs-comment">#   &quot;url&quot;: &quot;https://httpbin.org/post&quot;</span><br><span class="hljs-comment"># &#125;</span><br><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></td></tr></table></figure>

<h3 id="响应"><a href="#响应" class="headerlink" title="响应"></a>响应</h3><figure class="highlight python"><table><tr><td class="code"><pre class="line-numbers language-hljs python"><span class="hljs-keyword">import</span> requests<br><br>response = requests.get(<span class="hljs-string">&#x27;http://www.baidu.com&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(response))<br><span class="hljs-comment"># &lt;class &#x27;requests.models.Response&#x27;&gt;</span><br><br><span class="hljs-built_in">print</span>(response.status_code)<br><span class="hljs-comment"># 200</span><br><br><span class="hljs-built_in">print</span>(response.text)<br><span class="hljs-comment"># &lt;!--STATUS OK--&gt;&lt;html&gt; &lt;head&gt;&lt;me ...</span><br><br><span class="hljs-built_in">print</span>(response.content)<br><span class="hljs-comment"># b&#x27;&lt;!DOCTYPE html&gt;\r\n&lt;!--STATUS OK--&gt;&lt;html&gt; &lt;head&gt;&lt;me ...</span><br><br><span class="hljs-built_in">print</span>(response.cookies)<br><span class="hljs-comment"># &lt;RequestsCookieJar[&lt;Cookie BDORZ=27315 for .baidu.com/&gt;]&gt;</span><br><br><span class="hljs-built_in">print</span>(response.headers)<br><span class="hljs-comment"># &#123;&#x27;Cache-Control&#x27;: &#x27;private, no-cache, no-store, proxy-revalidate, no-transform&#x27;, &#x27;Connection&#x27;: &#x27;Keep-Alive&#x27;, &#x27;Content-Encoding&#x27;: &#x27;gzip&#x27;, &#x27;Content-Type&#x27;: &#x27;text/html&#x27;, &#x27;Date&#x27;: &#x27;Thu, 06 Jun 2019 02:01:14 GMT&#x27;, &#x27;Last-Modified&#x27;: &#x27;Mon, 23 Jan 2017 13:27:36 GMT&#x27;, &#x27;Pragma&#x27;: &#x27;no-cache&#x27;, &#x27;Server&#x27;: &#x27;bfe/1.0.8.18&#x27;, &#x27;Set-Cookie&#x27;: &#x27;BDORZ=27315; max-age=86400; domain=.baidu.com; path=/&#x27;, &#x27;Transfer-Encoding&#x27;: &#x27;chunked&#x27;&#125;</span><br><br><span class="hljs-built_in">print</span>(response.encoding)<br><span class="hljs-comment"># ISO-8859-1</span><br><span class="hljs-comment"># 如果响应 header 中没有 charset 字段，则默认 encoding 总是 ISO-8859-1</span><br><br><span class="hljs-built_in">print</span>(response.apparent_encoding)<br><span class="hljs-comment"># utf-8</span><br><span class="hljs-comment"><code class="language-hljs python"><span class="hljs-keyword">import</span> requests<br><br>response = requests.get(<span class="hljs-string">&#x27;http://www.baidu.com&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(response))<br><span class="hljs-comment"># &lt;class &#x27;requests.models.Response&#x27;&gt;</span><br><br><span class="hljs-built_in">print</span>(response.status_code)<br><span class="hljs-comment"># 200</span><br><br><span class="hljs-built_in">print</span>(response.text)<br><span class="hljs-comment"># &lt;!--STATUS OK--&gt;&lt;html&gt; &lt;head&gt;&lt;me ...</span><br><br><span class="hljs-built_in">print</span>(response.content)<br><span class="hljs-comment"># b&#x27;&lt;!DOCTYPE html&gt;\r\n&lt;!--STATUS OK--&gt;&lt;html&gt; &lt;head&gt;&lt;me ...</span><br><br><span class="hljs-built_in">print</span>(response.cookies)<br><span class="hljs-comment"># &lt;RequestsCookieJar[&lt;Cookie BDORZ=27315 for .baidu.com/&gt;]&gt;</span><br><br><span class="hljs-built_in">print</span>(response.headers)<br><span class="hljs-comment"># &#123;&#x27;Cache-Control&#x27;: &#x27;private, no-cache, no-store, proxy-revalidate, no-transform&#x27;, &#x27;Connection&#x27;: &#x27;Keep-Alive&#x27;, &#x27;Content-Encoding&#x27;: &#x27;gzip&#x27;, &#x27;Content-Type&#x27;: &#x27;text/html&#x27;, &#x27;Date&#x27;: &#x27;Thu, 06 Jun 2019 02:01:14 GMT&#x27;, &#x27;Last-Modified&#x27;: &#x27;Mon, 23 Jan 2017 13:27:36 GMT&#x27;, &#x27;Pragma&#x27;: &#x27;no-cache&#x27;, &#x27;Server&#x27;: &#x27;bfe/1.0.8.18&#x27;, &#x27;Set-Cookie&#x27;: &#x27;BDORZ=27315; max-age=86400; domain=.baidu.com; path=/&#x27;, &#x27;Transfer-Encoding&#x27;: &#x27;chunked&#x27;&#125;</span><br><br><span class="hljs-built_in">print</span>(response.encoding)<br><span class="hljs-comment"># ISO-8859-1</span><br><span class="hljs-comment"># 如果响应 header 中没有 charset 字段，则默认 encoding 总是 ISO-8859-1</span><br><br><span class="hljs-built_in">print</span>(response.apparent_encoding)<br><span class="hljs-comment"># utf-8</span><br><span class="hljs-comment"># apparent_encoding 是从内容中分析出的编码方式</span><br><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></td></tr></table></figure>

<h3 id="状态码"><a href="#状态码" class="headerlink" title="状态码"></a>状态码</h3><figure class="highlight python"><table><tr><td class="code"><pre class="line-numbers language-hljs python"><span class="hljs-keyword">import</span> requests<br><br>response = requests.get(<span class="hljs-string">&#x27;http://www.baidu.com&#x27;</span>)<br><span class="hljs-comment"># if not response.status_code == 200:</span><br><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> response.status_code == requests.codes.ok:<br>    <span class="hljs-keyword">pass</span><br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Successfuly&#x27;</span>)<br><br><span class="hljs-keyword">try</span>:<br>    response = requests.get(<span class="hljs-string">&#x27;http://httpbin.org/post&#x27;</span>, timeout=<span class="hljs-number">10</span>)<br>    response.raise_for_status() <span class="hljs-comment"># 如果状态码不是 200，则产生异常</span><br>    response.encoding = reqponse.apparent_encoding<br>    <span class="hljs-built_in">print</span>(response.text)<br><span class="hljs-keyword">except</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string"><code class="language-hljs python"><span class="hljs-keyword">import</span> requests<br><br>response = requests.get(<span class="hljs-string">&#x27;http://www.baidu.com&#x27;</span>)<br><span class="hljs-comment"># if not response.status_code == 200:</span><br><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> response.status_code == requests.codes.ok:<br>    <span class="hljs-keyword">pass</span><br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Successfuly&#x27;</span>)<br><br><span class="hljs-keyword">try</span>:<br>    response = requests.get(<span class="hljs-string">&#x27;http://httpbin.org/post&#x27;</span>, timeout=<span class="hljs-number">10</span>)<br>    response.raise_for_status() <span class="hljs-comment"># 如果状态码不是 200，则产生异常</span><br>    response.encoding = reqponse.apparent_encoding<br>    <span class="hljs-built_in">print</span>(response.text)<br><span class="hljs-keyword">except</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;出现异常&#x27;</span>)<br><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></td></tr></table></figure>

<h3 id="高级操作"><a href="#高级操作" class="headerlink" title="高级操作"></a>高级操作</h3><h4 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h4><figure class="highlight python"><table><tr><td class="code"><pre class="line-numbers language-hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&#x27;http://httpbin.org/post&#x27;</span><br>files = &#123;<span class="hljs-string">&#x27;icon_file&#x27;</span>: <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;github.ico&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>)&#125;<br>response = requests.post(upload_url, files=files)<br><br><span class="hljs-built_in">print</span>(response.text)<br><br><span class="hljs-comment"># &#123;</span><br><span class="hljs-comment">#   &quot;args&quot;: &#123;&#125;, </span><br><span class="hljs-comment">#   &quot;data&quot;: &quot;&quot;, </span><br><span class="hljs-comment">#   &quot;files&quot;: &#123;</span><br><span class="hljs-comment">#     &quot;icon_file&quot;: &quot;data:application/octet-stream;base64,AAABAAIAEBAAAAEAIAAoBQAAJgAAACAgAAABACAAKBQAAE4FAAAoAA....=&quot;</span><br><span class="hljs-comment">#   &#125;, </span><br><span class="hljs-comment">#   &quot;form&quot;: &#123;&#125;, </span><br><span class="hljs-comment">#   &quot;headers&quot;: &#123;</span><br><span class="hljs-comment">#     &quot;Accept&quot;: &quot;*/*&quot;, </span><br><span class="hljs-comment">#     &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, </span><br><span class="hljs-comment">#     &quot;Content-Length&quot;: &quot;6669&quot;, </span><br><span class="hljs-comment">#     &quot;Content-Type&quot;: &quot;multipart/form-data; boundary=fc1bc945d7c8d8b01c9fd6714bba8fe8&quot;, </span><br><span class="hljs-comment">#     &quot;Host&quot;: &quot;httpbin.org&quot;, </span><br><span class="hljs-comment">#     &quot;User-Agent&quot;: &quot;python-requests/2.22.0&quot;</span><br><span class="hljs-comment">#   &#125;, </span><br><span class="hljs-comment">#   &quot;json&quot;: null, </span><br><span class="hljs-comment">#   &quot;origin&quot;: &quot;198.23.188.136, 198.23.188.136&quot;, </span><br><span class="hljs-comment">#   &quot;url&quot;: &quot;https://httpbin.org/post&quot;</span><br><span class="hljs-comment"><code class="language-hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&#x27;http://httpbin.org/post&#x27;</span><br>files = &#123;<span class="hljs-string">&#x27;icon_file&#x27;</span>: <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;github.ico&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>)&#125;<br>response = requests.post(upload_url, files=files)<br><br><span class="hljs-built_in">print</span>(response.text)<br><br><span class="hljs-comment"># &#123;</span><br><span class="hljs-comment">#   &quot;args&quot;: &#123;&#125;, </span><br><span class="hljs-comment">#   &quot;data&quot;: &quot;&quot;, </span><br><span class="hljs-comment">#   &quot;files&quot;: &#123;</span><br><span class="hljs-comment">#     &quot;icon_file&quot;: &quot;data:application/octet-stream;base64,AAABAAIAEBAAAAEAIAAoBQAAJgAAACAgAAABACAAKBQAAE4FAAAoAA....=&quot;</span><br><span class="hljs-comment">#   &#125;, </span><br><span class="hljs-comment">#   &quot;form&quot;: &#123;&#125;, </span><br><span class="hljs-comment">#   &quot;headers&quot;: &#123;</span><br><span class="hljs-comment">#     &quot;Accept&quot;: &quot;*/*&quot;, </span><br><span class="hljs-comment">#     &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, </span><br><span class="hljs-comment">#     &quot;Content-Length&quot;: &quot;6669&quot;, </span><br><span class="hljs-comment">#     &quot;Content-Type&quot;: &quot;multipart/form-data; boundary=fc1bc945d7c8d8b01c9fd6714bba8fe8&quot;, </span><br><span class="hljs-comment">#     &quot;Host&quot;: &quot;httpbin.org&quot;, </span><br><span class="hljs-comment">#     &quot;User-Agent&quot;: &quot;python-requests/2.22.0&quot;</span><br><span class="hljs-comment">#   &#125;, </span><br><span class="hljs-comment">#   &quot;json&quot;: null, </span><br><span class="hljs-comment">#   &quot;origin&quot;: &quot;198.23.188.136, 198.23.188.136&quot;, </span><br><span class="hljs-comment">#   &quot;url&quot;: &quot;https://httpbin.org/post&quot;</span><br><span class="hljs-comment"># &#125;</span><br><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></td></tr></table></figure>

<h4 id="会话维持"><a href="#会话维持" class="headerlink" title="会话维持"></a>会话维持</h4><figure class="highlight python"><table><tr><td class="code"><pre class="line-numbers language-hljs python"><span class="hljs-keyword">import</span> requests<br><br>requests.get(<span class="hljs-string">&#x27;http://httpbin.org/cookies/set/foo/bar&#x27;</span>)<br>response = requests.get(<span class="hljs-string">&#x27;http://httpbin.org/cookies&#x27;</span>)<br><br><span class="hljs-built_in">print</span>(response.text)<br><br><span class="hljs-comment"># &#123;</span><br><span class="hljs-comment">#   &quot;cookies&quot;: &#123;&#125;</span><br><span class="hljs-comment"># &#125;</span><br><br>session = requests.session()<br>session.get(<span class="hljs-string">&#x27;http://httpbin.org/cookies/set/foo/bar&#x27;</span>)<br>response = session.get(<span class="hljs-string">&#x27;http://httpbin.org/cookies&#x27;</span>)<br><br><span class="hljs-built_in">print</span>(response.text)<br><br><span class="hljs-comment"># &#123;</span><br><span class="hljs-comment">#   &quot;cookies&quot;: &#123;</span><br><span class="hljs-comment">#     &quot;foo&quot;: &quot;bar&quot;</span><br><span class="hljs-comment">#   &#125;</span><br><span class="hljs-comment"><code class="language-hljs python"><span class="hljs-keyword">import</span> requests<br><br>requests.get(<span class="hljs-string">&#x27;http://httpbin.org/cookies/set/foo/bar&#x27;</span>)<br>response = requests.get(<span class="hljs-string">&#x27;http://httpbin.org/cookies&#x27;</span>)<br><br><span class="hljs-built_in">print</span>(response.text)<br><br><span class="hljs-comment"># &#123;</span><br><span class="hljs-comment">#   &quot;cookies&quot;: &#123;&#125;</span><br><span class="hljs-comment"># &#125;</span><br><br>session = requests.session()<br>session.get(<span class="hljs-string">&#x27;http://httpbin.org/cookies/set/foo/bar&#x27;</span>)<br>response = session.get(<span class="hljs-string">&#x27;http://httpbin.org/cookies&#x27;</span>)<br><br><span class="hljs-built_in">print</span>(response.text)<br><br><span class="hljs-comment"># &#123;</span><br><span class="hljs-comment">#   &quot;cookies&quot;: &#123;</span><br><span class="hljs-comment">#     &quot;foo&quot;: &quot;bar&quot;</span><br><span class="hljs-comment">#   &#125;</span><br><span class="hljs-comment"># &#125;</span><br><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></td></tr></table></figure>

<h4 id="证书验证"><a href="#证书验证" class="headerlink" title="证书验证"></a>证书验证</h4><figure class="highlight python"><table><tr><td class="code"><pre class="line-numbers language-hljs python"><span class="hljs-keyword">import</span> requests<br><br>resresponsep = requests.get(<span class="hljs-string">&#x27;https://www.12306.cn&#x27;</span>, verify=<span class="hljs-literal">False</span>)<br><span class="hljs-built_in"><code class="language-hljs python"><span class="hljs-keyword">import</span> requests<br><br>resresponsep = requests.get(<span class="hljs-string">&#x27;https://www.12306.cn&#x27;</span>, verify=<span class="hljs-literal">False</span>)<br><span class="hljs-built_in">print</span>(response.status_code)<br><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></td></tr></table></figure>

<h4 id="代理设置"><a href="#代理设置" class="headerlink" title="代理设置"></a>代理设置</h4><figure class="highlight python"><table><tr><td class="code"><pre class="line-numbers language-hljs python"><span class="hljs-keyword">import</span> requests<br><br>proxies = &#123;<br>    <span class="hljs-string">&#x27;http&#x27;</span>: <span class="hljs-string">&#x27;http://112.85.173.34:9999&#x27;</span><br>    <span class="hljs-comment"># &#x27;https&#x27;: &#x27;https://222.128.9.235:59593&#x27;</span><br>&#125;<br><br>response = requests.get(<span class="hljs-string">&#x27;http://httpbin.org/get&#x27;</span>, proxies=proxies)<br><span class="hljs-built_in">print</span>(response.text)<br><br><span class="hljs-comment"># &#123;</span><br><span class="hljs-comment">#   &quot;args&quot;: &#123;&#125;, </span><br><span class="hljs-comment">#   &quot;headers&quot;: &#123;</span><br><span class="hljs-comment">#     &quot;Accept&quot;: &quot;*/*&quot;, </span><br><span class="hljs-comment">#     &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, </span><br><span class="hljs-comment">#     &quot;Cache-Control&quot;: &quot;max-age=259200&quot;, </span><br><span class="hljs-comment">#     &quot;Host&quot;: &quot;httpbin.org&quot;, </span><br><span class="hljs-comment">#     &quot;User-Agent&quot;: &quot;python-requests/2.22.0&quot;</span><br><span class="hljs-comment">#   &#125;, </span><br><span class="hljs-comment">#   &quot;origin&quot;: &quot;112.85.173.34, 112.85.173.34&quot;, </span><br><span class="hljs-comment">#   &quot;url&quot;: &quot;https://httpbin.org/get&quot;</span><br><span class="hljs-comment"><code class="language-hljs python"><span class="hljs-keyword">import</span> requests<br><br>proxies = &#123;<br>    <span class="hljs-string">&#x27;http&#x27;</span>: <span class="hljs-string">&#x27;http://112.85.173.34:9999&#x27;</span><br>    <span class="hljs-comment"># &#x27;https&#x27;: &#x27;https://222.128.9.235:59593&#x27;</span><br>&#125;<br><br>response = requests.get(<span class="hljs-string">&#x27;http://httpbin.org/get&#x27;</span>, proxies=proxies)<br><span class="hljs-built_in">print</span>(response.text)<br><br><span class="hljs-comment"># &#123;</span><br><span class="hljs-comment">#   &quot;args&quot;: &#123;&#125;, </span><br><span class="hljs-comment">#   &quot;headers&quot;: &#123;</span><br><span class="hljs-comment">#     &quot;Accept&quot;: &quot;*/*&quot;, </span><br><span class="hljs-comment">#     &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, </span><br><span class="hljs-comment">#     &quot;Cache-Control&quot;: &quot;max-age=259200&quot;, </span><br><span class="hljs-comment">#     &quot;Host&quot;: &quot;httpbin.org&quot;, </span><br><span class="hljs-comment">#     &quot;User-Agent&quot;: &quot;python-requests/2.22.0&quot;</span><br><span class="hljs-comment">#   &#125;, </span><br><span class="hljs-comment">#   &quot;origin&quot;: &quot;112.85.173.34, 112.85.173.34&quot;, </span><br><span class="hljs-comment">#   &quot;url&quot;: &quot;https://httpbin.org/get&quot;</span><br><span class="hljs-comment"># &#125;</span><br><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></td></tr></table></figure>

<h4 id="超时设置"><a href="#超时设置" class="headerlink" title="超时设置"></a>超时设置</h4><figure class="highlight python"><table><tr><td class="code"><pre class="line-numbers language-hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> requests.exceptions <span class="hljs-keyword">import</span> ReadTimeout<br><br><span class="hljs-keyword">try</span>:<br>    response = requests.get(<span class="hljs-string">&#x27;http://httpbin.org/get&#x27;</span>, timeout=<span class="hljs-number">0.1</span>)<br>    <span class="hljs-built_in">print</span>(response.status_code)<br><span class="hljs-keyword">except</span> ReadTimeout:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string"><code class="language-hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> requests.exceptions <span class="hljs-keyword">import</span> ReadTimeout<br><br><span class="hljs-keyword">try</span>:<br>    response = requests.get(<span class="hljs-string">&#x27;http://httpbin.org/get&#x27;</span>, timeout=<span class="hljs-number">0.1</span>)<br>    <span class="hljs-built_in">print</span>(response.status_code)<br><span class="hljs-keyword">except</span> ReadTimeout:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;TIME OUT&#x27;</span>)<br><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></td></tr></table></figure>

<h4 id="认证设置"><a href="#认证设置" class="headerlink" title="认证设置"></a>认证设置</h4><figure class="highlight python"><table><tr><td class="code"><pre class="line-numbers language-hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> requests.auth <span class="hljs-keyword">import</span> HTTPBasicAuth<br><br>response = requests.get(<span class="hljs-string">&#x27;http://auth_demo.com&#x27;</span>, auth=HTTPBasicAuth(<span class="hljs-string">&#x27;user&#x27;</span>, <span class="hljs-number">123456</span>))<br><span class="hljs-comment"><code class="language-hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> requests.auth <span class="hljs-keyword">import</span> HTTPBasicAuth<br><br>response = requests.get(<span class="hljs-string">&#x27;http://auth_demo.com&#x27;</span>, auth=HTTPBasicAuth(<span class="hljs-string">&#x27;user&#x27;</span>, <span class="hljs-number">123456</span>))<br><span class="hljs-comment"># response = requests.get(&#x27;http://auth_demo.com&#x27;, auth=(&#x27;user&#x27;, 123456))</span><br><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></td></tr></table></figure>

<h4 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h4><p>requests 库总共有 6 种异常: </p>
<ul>
<li>requests.ConnectionError: 网络连接错误异常，如 DNS 查询失败，拒绝连接等</li>
<li>requests.HTTPError: HTTP 错误异常</li>
<li>requests.URLRequired: URL 缺失异常</li>
<li>requests.TooManyRedirects: 超过最大重定向次数</li>
<li>requests.ConnectTimeout: 连接远程服务器超时异常</li>
<li>requests.Timeout: 请求 URL 超时异常</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre class="line-numbers language-hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> requests.exceptions <span class="hljs-keyword">import</span> ReadTimeout, HTTPError, RequestException<br><br><span class="hljs-keyword">try</span>:<br>    response = requests.get(<span class="hljs-string">&#x27;http://httpbin.org/get&#x27;</span>, timeout=<span class="hljs-number">0.1</span>)<br>    <span class="hljs-built_in">print</span>(response.status_code)<br><span class="hljs-keyword">except</span> ReadTimeout:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;TIME OUT&#x27;</span>)<br><span class="hljs-keyword">except</span> HTTPError:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;HTTP Error&#x27;</span>)<br><span class="hljs-keyword">except</span> RequestException:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string"><code class="language-hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> requests.exceptions <span class="hljs-keyword">import</span> ReadTimeout, HTTPError, RequestException<br><br><span class="hljs-keyword">try</span>:<br>    response = requests.get(<span class="hljs-string">&#x27;http://httpbin.org/get&#x27;</span>, timeout=<span class="hljs-number">0.1</span>)<br>    <span class="hljs-built_in">print</span>(response.status_code)<br><span class="hljs-keyword">except</span> ReadTimeout:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;TIME OUT&#x27;</span>)<br><span class="hljs-keyword">except</span> HTTPError:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;HTTP Error&#x27;</span>)<br><span class="hljs-keyword">except</span> RequestException:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Error&#x27;</span>)<br><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></td></tr></table></figure>

<h2 id="Robots-协议"><a href="#Robots-协议" class="headerlink" title="Robots 协议"></a>Robots 协议</h2><hr>
<p>Robots 协议告知所有爬虫网站的爬取策略，要求爬虫遵守。<br>Robots 协议放置在网站根目录下的 robots.txt 中，如: <a target="_blank" rel="noopener" href="http://www.zhihu.com/robots.txt%EF%BC%8C%E5%91%8A%E7%9F%A5%E7%BD%91%E7%AB%99%E7%9A%84%E7%88%AC%E5%8F%96%E8%A7%84%E5%88%99%E3%80%82">www.zhihu.com/robots.txt，告知网站的爬取规则。</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre class="line-numbers language-hljs txt"><code class="language-hljs txt">User-agent: Googlebot<br>Disallow: /login<br>Disallow: /logout<br>Disallow: /resetpassword<br>Disallow: /terms<br>Disallow: /search<br>Disallow: /notifications<br>Disallow: /settings<br>Disallow: /inbox<br>Disallow: /admin_inbox<br>Disallow: /*?guide*<br><br>...<br><br>User-Agent: *<br>Disallow: /<br><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></td></tr></table></figure>

<p><strong>特别注意: 不遵守 Robots 协议可能存在法律风险。</strong></p>
</p></div><div class="pagination"><p class="clearfix"><span class="pre pagbuttons"><a role="navigation" href="/Python(%E5%8D%81%E4%BA%8C)/" title=""><i class="fa fa-angle-double-left"></i>&nbsp;上一篇: </a></span><span>&nbsp;</span><span class="next pagbuttons"><a role="navigation" href="/Python(%E5%8D%81%E5%9B%9B)/" title="">下一篇: &nbsp;<i class="fa fa-angle-double-right"></i></a></span></p></div></div></div></div><div class="visible-xs site-bottom-footer"><footer><p>&copy;&nbsp;2021&nbsp;</p><p>如果五分钟后她必须进安检，如果安检在十米之外</p><p>那意味着，你们可以亲吻四分五十秒。&nbsp;</p></footer></div></div></div></div><script src="/js/jquery-3.1.0.min.js"></script><script src="/js/bootstrap.min.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script><script src="/js/google-analytics.js"></script><script src="/js/typography.js"></script></body></html>