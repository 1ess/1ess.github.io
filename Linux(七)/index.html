<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author"><title> · A Sort Of A Blog</title><meta name="description" content="破帽遮颜过闹市，漏船载酒泛中流，躲进小楼成一统，管他冬夏与春秋。 

本篇，我们在来说一下在 Linux 下，有关进程和内存与磁盘的相关知识。
进程
进程的查看常用查看命令: 

ps
pstree
top

进程的控制命令跳转优先级
nice: 范围 -20 到 19，值越小优先级越高
renic"><meta name="keywords" content=""><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="https://cdn.jsdelivr.net/gh/1ess/cdn/h4cker/favicon-32x32.png" type="image/x-icon"><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="stylesheet" href="/css/style-dark.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><meta name="generator" content="Hexo 5.4.0"></head><body><div id="stage" class="container"><div class="row"><div id="side-bar" class="col-sm-3 col-xs-12 side-container invisible"><div class="vertical-text site-title"><h3 tabindex="-1" class="site-title-small"><a href="/" class="a-title">0x7c00</a></h3><h1 tabindex="-1" class="site-title-large"><a href="/" class="a-title">张冬冬的博客</a></h1><!--h6(onclick="triggerSiteNav()") Trigger--></div><br class="visible-lg visible-md visible-sm"><div id="site-nav" class="site-title-links"><ul><li><a href="/">首頁</a></li><li><a href="/archives">歸檔</a></li><li class="soc"><a href="https://github.com/1ess" target="_blank" rel="noopener noreferrer"><i class="fa fa-github">&nbsp;</i></a><a href="https://1ess.github.io/atom.xml" target="_blank" rel="noopener noreferrer"><i class="fa fa-rss">&nbsp;</i></a></li></ul><div class="visible-lg visible-md visible-sm site-nav-footer"><br class="site-nav-footer-br"><footer><p>&copy;&nbsp;2021&nbsp;</p><p>如果五分钟后她必须进安检，如果安检在十米之外</p><p>那意味着，你们可以亲吻四分五十秒。&nbsp;</p></footer></div></div></div><div id="main-container" class="col-sm-9 col-xs-12 main-container invisible"><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post-container"><p class="post-title"><a></a></p><p class="post-meta"><span class="date meta-item">發佈於&nbsp;2021-07-14</span></p><p class="post-abstract"><blockquote>
<p>破帽遮颜过闹市，漏船载酒泛中流，躲进小楼成一统，管他冬夏与春秋。 </p>
</blockquote>
<p>本篇，我们在来说一下在 Linux 下，有关进程和内存与磁盘的相关知识。</p>
<h2 id="进程"><a href="#进程" class="headerlink" title="进程"></a>进程</h2><hr>
<h3 id="进程的查看"><a href="#进程的查看" class="headerlink" title="进程的查看"></a>进程的查看</h3><p>常用查看命令: </p>
<ul>
<li>ps</li>
<li>pstree</li>
<li>top</li>
</ul>
<h3 id="进程的控制命令"><a href="#进程的控制命令" class="headerlink" title="进程的控制命令"></a>进程的控制命令</h3><h4 id="跳转优先级"><a href="#跳转优先级" class="headerlink" title="跳转优先级"></a>跳转优先级</h4><ul>
<li>nice: 范围 -20 到 19，值越小优先级越高</li>
<li>renice</li>
</ul>
<h4 id="作业控制"><a href="#作业控制" class="headerlink" title="作业控制"></a>作业控制</h4><ul>
<li>ctrl+z: 停止作业</li>
<li>jobs: 获取作业列表</li>
<li>fg [任务编号]: 使其为前台作业运行</li>
<li>bg [任务编号]: 使其为后台作业运行</li>
</ul>
<h3 id="进程的通信方式-——-信号"><a href="#进程的通信方式-——-信号" class="headerlink" title="进程的通信方式 —— 信号"></a>进程的通信方式 —— 信号</h3><p>信号是进程间通信的方式之一。<br>常用命令: </p>
<ul>
<li>kill -l: 查看支持的信号</li>
<li>ctrl+c: SIGINT</li>
<li>kill -9 [pid]: SIGKILL </li>
<li>kill [pid]: SIGTERM</li>
</ul>
<h3 id="服务管理-systemctl"><a href="#服务管理-systemctl" class="headerlink" title="服务管理 systemctl"></a>服务管理 systemctl</h3><p>CentOS 7 之前，使用 service 命令来管理服务，7 之后使用 systemctl 命令来管理服务。<br>软件包安装的服务单元存储在 /usr/lib/systemd/system/</p>
<p>常见操作: </p>
<figure class="highlight sh"><table><tr><td class="code"><pre><code class="hljs sh">systemctl start/stop/restart/reload/<span class="hljs-built_in">enable</span>/<span class="hljs-built_in">disable</span>/status [服务名]<br>systemctl daemon-reload<br></code></pre></td></tr></table></figure>

<h3 id="SELinux"><a href="#SELinux" class="headerlink" title="SELinux"></a>SELinux</h3><p>安全增强式 Linux(SELinux，Security-Enhanced Linux)是一个 Linux 内核的安全模组，其提供了访问控制安全策略机制。</p>
<h2 id="内存与磁盘"><a href="#内存与磁盘" class="headerlink" title="内存与磁盘"></a>内存与磁盘</h2><hr>
<h3 id="查看内存和磁盘的使用率"><a href="#查看内存和磁盘的使用率" class="headerlink" title="查看内存和磁盘的使用率"></a>查看内存和磁盘的使用率</h3><ul>
<li>内存查看常用指令: </li>
</ul>
<ol>
<li>top</li>
<li>free</li>
</ol>
<ul>
<li>磁盘查看常用指令: </li>
</ul>
<ol>
<li>fdisk</li>
<li>df</li>
<li>du</li>
</ol>
<h3 id="ext4-文件系统"><a href="#ext4-文件系统" class="headerlink" title="ext4 文件系统"></a>ext4 文件系统</h3><p>Linux 支持多种文件系统，常见的有: ext4，xfs，NTFS(需要安装额外软件)<br>ext4 文件系统基本结构比较复杂: </p>
<ul>
<li>超级块</li>
<li>超级块副本</li>
<li>inode</li>
<li>datablock</li>
</ul>
<p>其中 inode 是非常重要的，是理解 Unix/Linux 文件系统和硬盘储存的基础。<br>文件储存在硬盘上，硬盘的<strong>文件存储</strong>单位叫做”扇区”(Sector)。每个扇区储存 512 字节(相当于 0.5KB)<br>操作系统读取硬盘的时候，不会一个个扇区地读取，而是一次性连续读取多个扇区，即一次性读取一个”块”(block)。这种由多个扇区组成的”块”，是<strong>文件存取</strong>的最小单位。”块”的大小，最常见的是 4KB，即连续八个 sector 组成一个 block。</p>
<p>文件数据都储存在”块”中，那么很显然，我们还必须找到一个地方储存文件的元信息，比如文件的创建者、创建日期、大小等等。这种储存文件元信息的区域就叫做 inode。</p>
<p>可以用 stat 命令，查看某个文件的 inode 信息: </p>
<figure class="highlight sh"><table><tr><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">stat</span> xx.md<br></code></pre></td></tr></table></figure>

<p><strong>特别注意: 除了文件名以外的所有文件信息，都存在 inode 之中。</strong></p>
<h4 id="inode-号码"><a href="#inode-号码" class="headerlink" title="inode 号码"></a>inode 号码</h4><p>每个 inode 都有一个号码，Unix/Linux 系统内部不使用文件名，而使用 inode 号码来识别文件。<br>表面上，用户通过文件名，打开文件。实际上，系统内部这个过程分成三步: </p>
<ol>
<li>首先，系统找到这个文件名对应的 inode 号码</li>
<li>其次，通过 inode 号码，获取 inode 信息</li>
<li>最后，根据 inode 信息，找到文件数据所在的 block，读出数据</li>
</ol>
<h4 id="硬链接"><a href="#硬链接" class="headerlink" title="硬链接"></a>硬链接</h4><p>一般情况下，文件名和 inode 号码是”一一对应”关系，每个 inode 号码对应一个文件名。但是，Unix/Linux 系统允许，多个文件名指向同一个 inode 号码。这意味着，可以用不同的文件名访问同样的内容；对文件内容进行修改，会影响到所有文件名；但是，删除一个文件名，不影响另一个文件名的访问。这种情况就被称为”硬链接”(hard link)。</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><code class="hljs sh">ln [源文件] [目标文件]<br></code></pre></td></tr></table></figure>

<p>inode 信息中有一项叫做”链接数”，记录指向该 inode 的文件名总数，这时就会增加 1。<br>反过来，删除一个文件名，就会使得 inode 节点中的”链接数”减 1。当这个值减到 0，系统就会回收这个 inode 号码，以及其所对应 block 区域。</p>
<p>注意: 每个目录都有 . 和 ..，前者的 inode 号码就是当前目录的 inode 号码，等同于当前目录的”硬链接”；后者的 inode 号码就是当前目录的父目录的 inode 号码，等同于父目录的”硬链接”。所以，任何一个目录的”硬链接”总数，总是等于 1 加上它的子目录总数。</p>
<h4 id="软链接"><a href="#软链接" class="headerlink" title="软链接"></a>软链接</h4><p>文件 A 和文件 B 的 inode 号码虽然不一样，但是文件 A 的内容是文件 B 的路径。读取文件 A 时，系统会自动将访问者导向文件 B。因此，无论打开哪一个文件，最终读取的都是文件 B。这时，文件 A 就称为文件B的”软链接”(soft link)<br>这意味着，文件 A 依赖于文件 B 而存在，如果删除了文件 B，打开文件 A 就会报错: “No such file or directory”。这是软链接与硬链接最大的不同。</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><code class="hljs sh">ln -s [源文文件或目录] [目标文件或目录]<br></code></pre></td></tr></table></figure>

<h2 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h2><hr>
<p>Linux 中，常见的日志: </p>
<ul>
<li>定时任务: /var/log/cron</li>
<li>打印信息: /var/log/cups/</li>
<li>错误登录: /var/log/btmp，不能直接查看，需要使用 lastb 命令查看</li>
<li>重要信息: /var/log/messages，如果系统出现问题，首先要检查该文件</li>
</ul>
<h3 id="文件格式"><a href="#文件格式" class="headerlink" title="文件格式"></a>文件格式</h3><p>日志文件格式为: 事件产生时间 发生事件的服务器名称 发生事件的服务名称 事件的具体信息</p>
</p></div><div class="pagination"><p class="clearfix"><span class="pre pagbuttons"><a role="navigation" href="/Linux(%E5%85%AD)/" title=""><i class="fa fa-angle-double-left"></i>&nbsp;上一篇: </a></span><span>&nbsp;</span><span class="next pagbuttons"><a role="navigation" href="/Linux(%E5%85%AB)/" title="">下一篇: &nbsp;<i class="fa fa-angle-double-right"></i></a></span></p></div></div></div></div><div class="visible-xs site-bottom-footer"><footer><p>&copy;&nbsp;2021&nbsp;</p><p>如果五分钟后她必须进安检，如果安检在十米之外</p><p>那意味着，你们可以亲吻四分五十秒。&nbsp;</p></footer></div></div></div></div><script src="/js/jquery-3.1.0.min.js"></script><script src="/js/bootstrap.min.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script><script src="/js/google-analytics.js"></script><script src="/js/typography.js"></script></body></html>