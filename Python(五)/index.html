<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author"><title> · A Sort Of A Blog</title><meta name="description" content="本篇，我们说说 Python 中的面向对象编程的基本概念。
概念
面向对象最重要的概念就是类(Class)和实例(Instance)。一个类(Class)能够创建一种新的类型(Type)，其中对象(Object)就是类的实例(Instance)。可以这样来类比: 你可以拥有类型 int 的变量，也就"><meta name="keywords" content=""><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="https://cdn.jsdelivr.net/gh/1ess/cdn/h4cker/favicon-32x32.png" type="image/x-icon"><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="stylesheet" href="/css/style.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><meta name="generator" content="Hexo 5.4.0"><link rel="stylesheet" href="/css/prism.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div id="stage" class="container"><div class="row"><div id="side-bar" class="col-sm-3 col-xs-12 side-container invisible"><div class="vertical-text site-title"><h3 tabindex="-1" class="site-title-small"><a href="/" class="a-title">0x7c00</a></h3><h1 tabindex="-1" class="site-title-large"><a href="/" class="a-title">张冬冬的博客</a></h1><!--h6(onclick="triggerSiteNav()") Trigger--></div><br class="visible-lg visible-md visible-sm"><div id="site-nav" class="site-title-links"><ul><li><a href="/">首頁</a></li><li><a href="/archives">歸檔</a></li><li class="soc"><a href="https://github.com/1ess" target="_blank" rel="noopener noreferrer"><i class="fa fa-github">&nbsp;</i></a></li></ul><div class="visible-lg visible-md visible-sm site-nav-footer"><br class="site-nav-footer-br"><footer><p>&copy;&nbsp;2021&nbsp;</p><p>如果五分钟后她必须进安检，如果安检在十米之外</p><p>那意味着，你们可以亲吻四分五十秒。&nbsp;</p></footer></div></div></div><div id="main-container" class="col-sm-9 col-xs-12 main-container invisible"><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post-container"><p class="post-title"><a></a></p><p class="post-meta"><span class="date meta-item">發佈於&nbsp;2021-07-14</span></p><p class="post-abstract"><p>本篇，我们说说 Python 中的面向对象编程的基本概念。</p>
<h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><hr>
<p>面向对象最重要的概念就是类(Class)和实例(Instance)。一个类(Class)能够创建一种新的类型(Type)，其中对象(Object)就是类的实例(Instance)。可以这样来类比: 你可以拥有类型 int 的变量，也就是说存储整数的变量是 int 类的实例(对象)。<br>注意: Python 中，即使是整数也会被视为对象(int 类的对象)，类似 C# 和 Java 中的装箱与拆箱。</p>
<p>对象可以使用属于它的普通变量来存储数据。这种从属于对象或类的变量叫作字段(Field)。对象还可以使用属于类的函数来实现某些功能，这种函数叫作类的方法(Method)。这两个术语很重要，它有助于我们区分函数与变量，哪些是独立的，哪些又是属于类或对象的。总之，字段与方法通称类的属性(Attribute)。</p>
<p>字段有两种类型 —— 它们属于某一类的各个实例或对象，或是从属于某一类本身。它们被分别称作实例变量(Instance Variables)与类变量(Class Variables)。</p>
<h3 id="self"><a href="#self" class="headerlink" title="self"></a>self</h3><p>类方法与普通函数只有一种特定的区别 —— 前者必须多加一个参数在参数列表开头，但是你不用在你调用这个功能时为这个参数赋值，Python 会为它提供。这种特定的变量引用的是对象本身，按照惯例，它被赋予 self 这一名称。</p>
<h3 id="类"><a href="#类" class="headerlink" title="类"></a>类</h3><p>在Python中，定义类是通过 class 关键字: </p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>  <span class="token comment" spellcheck="true"># 一个空的代码块</span>

p <span class="token operator">=</span> Person<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>我们通过采用类的名称后跟一对括号的方法，给这个类创建一个对象。</p>
<h3 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h3><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">say_hi</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Hello, how are you?'</span><span class="token punctuation">)</span>

p <span class="token operator">=</span> Person<span class="token punctuation">(</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span>say_hi<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="init-方法"><a href="#init-方法" class="headerlink" title="__init__ 方法"></a>__init__ 方法</h3><p>在 Python 的类中，有不少方法的名称具有着特殊的意义。__init__ 方法会在类的对象被实例化(Instantiated)时立即运行。相当于其他语言中的构造方法。</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name

    <span class="token keyword">def</span> <span class="token function">say_hi</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Hello, my name is'</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>name<span class="token punctuation">)</span>

p <span class="token operator">=</span> Person<span class="token punctuation">(</span><span class="token string">'Swaroop'</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span>say_hi<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="类变量与对象变量"><a href="#类变量与对象变量" class="headerlink" title="类变量与对象变量"></a>类变量与对象变量</h3><p>字段(Field)有两种类型 —— 类变量与对象变量，它们根据究竟是类还是对象拥有这些变量来进行分类。</p>
<p>类变量(Class Variable)是共享的(Shared)—— 它们可以被属于该类的所有实例访问。该类变量只拥有一个副本，当任何一个对象对类变量作出改变时，发生的变动将在其它所有实例中都会得到体现。<br>对象变量(Object variable)由类的每一个独立的对象或实例所拥有。在这种情况下，每个对象都拥有属于它自己的字段的副本。</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Robot</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""表示有一个带有名字的机器人。"""</span>

    <span class="token comment" spellcheck="true"># 一个类变量，用来计数机器人的数量</span>
    population <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""初始化数据"""</span>
        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"(Initializing &amp;#123;&amp;#125;)"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>self<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token comment" spellcheck="true"># 当有人被创建时，机器人</span>
        <span class="token comment" spellcheck="true"># 将会增加人口数量</span>
        Robot<span class="token punctuation">.</span>population <span class="token operator">+=</span> <span class="token number">1</span>

    <span class="token keyword">def</span> <span class="token function">die</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""我挂了。"""</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"&amp;#123;&amp;#125; is being destroyed!"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>self<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>

        Robot<span class="token punctuation">.</span>population <span class="token operator">-=</span> <span class="token number">1</span>

        <span class="token keyword">if</span> Robot<span class="token punctuation">.</span>population <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"&amp;#123;&amp;#125; was the last one."</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>self<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"There are still &amp;#123;:d&amp;#125; robots working."</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>
                Robot<span class="token punctuation">.</span>population<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">say_hi</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""来自机器人的诚挚问候

        没问题，你做得到。"""</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Greetings, my masters call me &amp;#123;&amp;#125;."</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>self<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>

    @classmethod
    <span class="token keyword">def</span> <span class="token function">how_many</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""打印出当前的人口数量"""</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"We have &amp;#123;:d&amp;#125; robots."</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>cls<span class="token punctuation">.</span>population<span class="token punctuation">)</span><span class="token punctuation">)</span>


droid1 <span class="token operator">=</span> Robot<span class="token punctuation">(</span><span class="token string">"R2-D2"</span><span class="token punctuation">)</span>
droid1<span class="token punctuation">.</span>say_hi<span class="token punctuation">(</span><span class="token punctuation">)</span>
Robot<span class="token punctuation">.</span>how_many<span class="token punctuation">(</span><span class="token punctuation">)</span>

droid2 <span class="token operator">=</span> Robot<span class="token punctuation">(</span><span class="token string">"C-3PO"</span><span class="token punctuation">)</span>
droid2<span class="token punctuation">.</span>say_hi<span class="token punctuation">(</span><span class="token punctuation">)</span>
Robot<span class="token punctuation">.</span>how_many<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nRobots can do some work here.\n"</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Robots have finished their work. So let's destroy them."</span><span class="token punctuation">)</span>
droid1<span class="token punctuation">.</span>die<span class="token punctuation">(</span><span class="token punctuation">)</span>
droid2<span class="token punctuation">.</span>die<span class="token punctuation">(</span><span class="token punctuation">)</span>

Robot<span class="token punctuation">.</span>how_many<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>上例中，population 属于 Robot 类，因此它是一个类变量。name 变量属于一个对象(通过使用 self 分配)，因此它是一个对象变量。<br>因此，我们通过 Robot.population 而非 self.population 引用 population 类变量。我们对于 name 对象变量采用 self.name 标记法加以称呼。<br>注意: 当一个对象变量与一个类变量名称相同时，类变量将会被隐藏。如果访问实例属性不存在的话，会继续访问类属性。</p>
<p>除了 Robot.popluation，我们还可以使用 self.__class__.population，因为每个对象都通过 self.__class__ 属性来引用它的类。</p>
<p>how_many 实际上是一个属于类而非属于对象的方法。这就意味着我们可以将它定义为一个 classmethod(类方法) 或是一个 staticmethod(静态方法)。我们使用装饰器(Decorator)将 how_many 方法标记为类方法。</p>
<p>classmethod 和 staticmethod 方法区别是 classmethod 有一个名为 cls 参数，指向该类。</p>
<p>可以将装饰器想象为调用一个包装器(Wrapper)函数的快捷方式，因此启用 @classmethod 装饰器等价于调用: </p>
<pre class="line-numbers language-python"><code class="language-python">how_many <span class="token operator">=</span> classmethod<span class="token punctuation">(</span>how_many<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>注意: Python 中所有类成员(包括数据成员)都是公开的，并且所有的方法都是虚方法(Virtual)。</p>
<h3 id="继承和多态"><a href="#继承和多态" class="headerlink" title="继承和多态"></a>继承和多态</h3><p>面向对象编程的一大优点是对代码的重用(Reuse)，重用的一种实现方法就是通过继承(Inheritance)机制。<br>新类会被称作基类(Base Class)或是超类(Superclass)。被继承的类会被称作派生类(Derived Classes)或是子类(Subclass)。</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">SchoolMember</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''代表任何学校里的成员。'''</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name
        self<span class="token punctuation">.</span>age <span class="token operator">=</span> age
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'(Initialized SchoolMember: &amp;#123;&amp;#125;)'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>self<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">tell</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''告诉我有关我的细节。'''</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Name:"&amp;#123;&amp;#125;" Age:"&amp;#123;&amp;#125;"'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>self<span class="token punctuation">.</span>name<span class="token punctuation">,</span> self<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">" "</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">Teacher</span><span class="token punctuation">(</span>SchoolMember<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''代表一位老师。'''</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> salary<span class="token punctuation">)</span><span class="token punctuation">:</span>
        SchoolMember<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>salary <span class="token operator">=</span> salary
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'(Initialized Teacher: &amp;#123;&amp;#125;)'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>self<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">tell</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        SchoolMember<span class="token punctuation">.</span>tell<span class="token punctuation">(</span>self<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Salary: "&amp;#123;:d&amp;#125;"'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>self<span class="token punctuation">.</span>salary<span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">Student</span><span class="token punctuation">(</span>SchoolMember<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''代表一位学生。'''</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> marks<span class="token punctuation">)</span><span class="token punctuation">:</span>
        SchoolMember<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>marks <span class="token operator">=</span> marks
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'(Initialized Student: &amp;#123;&amp;#125;)'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>self<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">tell</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        SchoolMember<span class="token punctuation">.</span>tell<span class="token punctuation">(</span>self<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Marks: "&amp;#123;:d&amp;#125;"'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>self<span class="token punctuation">.</span>marks<span class="token punctuation">)</span><span class="token punctuation">)</span>

t <span class="token operator">=</span> Teacher<span class="token punctuation">(</span><span class="token string">'Mrs. Shrividya'</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">30000</span><span class="token punctuation">)</span>
s <span class="token operator">=</span> Student<span class="token punctuation">(</span><span class="token string">'Swaroop'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># 打印一行空白行</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

members <span class="token operator">=</span> <span class="token punctuation">[</span>t<span class="token punctuation">,</span> s<span class="token punctuation">]</span>
<span class="token keyword">for</span> member <span class="token keyword">in</span> members<span class="token punctuation">:</span>
    <span class="token comment" spellcheck="true"># 对全体师生工作</span>
    member<span class="token punctuation">.</span>tell<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>要想使用继承，在定义类时我们需要在类后面跟一个包含基类名称的元组。然后，我们会注意到基类的 __init__ 方法是通过 self 变量被显式调用的，因此我们可以初始化对象的基类部分。Python 不会自动调用基类的构造函数，你必须自己显式地调用它。</p>
<p>相反，如果我们没有在一个子类中定义一个 __init__ 方法，Python 将会自动调用基类的构造函数。</p>
<p>上例中，我们发现被调用的是子类型的 tell 方法，而不是 SchoolMember 的 tell 方法。理解这一问题的一种思路是 Python 总会从当前的实际类型中开始寻找方法，也就是多态。</p>
<p>end 参数用在超类的 tell() 方法的 print 函数中，目的是打印一行并允许下一次打印在同一行继续。这是一个让 print 能够不在打印的末尾打印出 \n (新行换行符)符号的小窍门。</p>
<h2 id="获取对象信息"><a href="#获取对象信息" class="headerlink" title="获取对象信息"></a>获取对象信息</h2><hr>
<p>当我们拿到一个对象的引用时，如何知道这个对象是什么类型、有哪些方法呢？</p>
<h3 id="type"><a href="#type" class="headerlink" title="type()"></a>type()</h3><p>基本类型都可以用 type() 判断: </p>
<pre class="line-numbers language-python"><code class="language-python">type<span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># &lt;class 'int'></span>
type<span class="token punctuation">(</span><span class="token string">'str'</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># &lt;class 'str'></span>
type<span class="token punctuation">(</span>None<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># &lt;type(None) 'NoneType'></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>如果一个变量指向函数或者类，也可以用 type() 判断: </p>
<pre class="line-numbers language-python"><code class="language-python">type<span class="token punctuation">(</span>abs<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># &lt;class 'builtin_function_or_method'></span>
type<span class="token punctuation">(</span>fn<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># &lt;class 'function'></span>
type<span class="token punctuation">(</span>p<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># &lt;class '__main__.Person'></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>type() 函数返回的是什么类型呢？它返回对应的 Class 类型: </p>
<pre class="line-numbers language-python"><code class="language-python">type<span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token operator">==</span>type<span class="token punctuation">(</span><span class="token number">456</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># True</span>
type<span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token operator">==</span>int
<span class="token comment" spellcheck="true"># True</span>
type<span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">)</span><span class="token operator">==</span>type<span class="token punctuation">(</span><span class="token string">'123'</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># True</span>
type<span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">)</span><span class="token operator">==</span>str
<span class="token comment" spellcheck="true"># True</span>

<span class="token keyword">import</span> types
type<span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token operator">==</span>types<span class="token punctuation">.</span>FunctionType
<span class="token comment" spellcheck="true"># True</span>
type<span class="token punctuation">(</span>abs<span class="token punctuation">)</span><span class="token operator">==</span>types<span class="token punctuation">.</span>BuiltinFunctionType
<span class="token comment" spellcheck="true"># True</span>
type<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">)</span><span class="token operator">==</span>types<span class="token punctuation">.</span>LambdaType
<span class="token comment" spellcheck="true"># True</span>
type<span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span>types<span class="token punctuation">.</span>GeneratorType
<span class="token comment" spellcheck="true"># True</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="isinstance"><a href="#isinstance" class="headerlink" title="isinstance()"></a>isinstance()</h3><p>对于继承关系来说，使用 type() 就很不方便。我们要判断 class 的类型，可以使用 isinstance() 函数。<br>继承关系如下:<br>object -&gt; Animal -&gt; Dog -&gt; Husky</p>
<pre class="line-numbers language-python"><code class="language-python">a <span class="token operator">=</span> Animal<span class="token punctuation">(</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> Dog<span class="token punctuation">(</span><span class="token punctuation">)</span>
h <span class="token operator">=</span> Husky<span class="token punctuation">(</span><span class="token punctuation">)</span>

isinstance<span class="token punctuation">(</span>h<span class="token punctuation">,</span> Husky<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># True</span>
isinstance<span class="token punctuation">(</span>h<span class="token punctuation">,</span> Dog<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># True</span>
isinstance<span class="token punctuation">(</span>d<span class="token punctuation">,</span> Husky<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># False</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>能用 type() 判断的基本类型也可以用 isinstance() 判断: </p>
<pre class="line-numbers language-python"><code class="language-python">isinstance<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> str<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># True</span>
isinstance<span class="token punctuation">(</span>b<span class="token string">'a'</span><span class="token punctuation">,</span> bytes<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># True</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>并且还可以判断一个变量是否是某些类型中的一种: </p>
<pre class="line-numbers language-python"><code class="language-python">isinstance<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>list<span class="token punctuation">,</span> tuple<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># True</span>
isinstance<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>list<span class="token punctuation">,</span> tuple<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># True</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="dir"><a href="#dir" class="headerlink" title="dir()"></a>dir()</h3><p>如果要获得一个对象的所有属性和方法，可以使用 dir() 函数，它返回一个包含字符串的 list。</p>
<pre class="line-numbers language-python"><code class="language-python">dir<span class="token punctuation">(</span><span class="token string">'ABC'</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># ['__add__', '__class__',..., '__subclasshook__', 'capitalize', 'casefold',..., 'zfill']</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>类似 __xxx__ 的属性和方法在 Python 中都是有特殊用途的，比如 __len__ 方法返回长度。在 Python 中，如果你调用 len() 函数试图获取一个对象的长度，实际上，在 len() 函数内部，它自动去调用该对象的 __len__() 方法: </p>
<pre class="line-numbers language-python"><code class="language-python">len<span class="token punctuation">(</span><span class="token string">'ABC'</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># 3</span>
<span class="token string">'ABC'</span><span class="token punctuation">.</span>__len__<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># 3</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>我们自己写的类，如果也想用 len(myObj) 的话，就自己写一个 __len__() 方法: </p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">MyDog</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>
     <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token keyword">return</span> <span class="token number">100</span>

dog <span class="token operator">=</span> MyDog<span class="token punctuation">(</span><span class="token punctuation">)</span>
len<span class="token punctuation">(</span>dog<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># 100</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>通过 getattr()、setattr() 以及 hasattr() 方法，我们可以直接操作一个对象的状态: </p>
<pre class="line-numbers language-python"><code class="language-python">hasattr<span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">'x'</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 有属性'x'吗？</span>
<span class="token comment" spellcheck="true"># True</span>
obj<span class="token punctuation">.</span>x
<span class="token comment" spellcheck="true"># 9</span>
hasattr<span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">'y'</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 有属性'y'吗？</span>
<span class="token comment" spellcheck="true"># False</span>
setattr<span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">'y'</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 设置一个属性'y'</span>
hasattr<span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">'y'</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 有属性'y'吗？</span>
<span class="token comment" spellcheck="true"># True</span>
getattr<span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">'y'</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 获取属性'y'</span>
<span class="token comment" spellcheck="true"># 19</span>
obj<span class="token punctuation">.</span>y <span class="token comment" spellcheck="true"># 获取属性'y'</span>
<span class="token comment" spellcheck="true"># 19</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>注意: 如果试图获取不存在的属性，会抛出 AttributeError 的错误。可以传入一个default参数，如果属性不存在，就返回默认值: </p>
<pre class="line-numbers language-python"><code class="language-python">getattr<span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">'z'</span><span class="token punctuation">,</span> <span class="token number">404</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 获取属性'z'，如果不存在，返回默认值404</span>
<span class="token comment" spellcheck="true"># 404</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</p></div><div class="pagination"><p class="clearfix"><span class="pre pagbuttons"><a role="navigation" href="/Python(%E5%9B%9B)/" title=""><i class="fa fa-angle-double-left"></i>&nbsp;上一篇: </a></span><span>&nbsp;</span><span class="next pagbuttons"><a role="navigation" href="/Python(%E5%85%AD)/" title="">下一篇: &nbsp;<i class="fa fa-angle-double-right"></i></a></span></p></div></div></div></div><div class="visible-xs site-bottom-footer"><footer><p>&copy;&nbsp;2021&nbsp;</p><p>如果五分钟后她必须进安检，如果安检在十米之外</p><p>那意味着，你们可以亲吻四分五十秒。&nbsp;</p></footer></div></div></div></div><script src="/js/jquery-3.1.0.min.js"></script><script src="/js/bootstrap.min.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script><script src="/js/google-analytics.js"></script><script src="/js/typography.js"></script></body></html>